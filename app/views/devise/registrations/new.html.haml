=render "/static_pages/partials/subheader"
/ content begin
#content
  .container.project-view
    .row
      = form_for(@user,:url => registration_path(resource_name), :validate => true) do |f|
        = devise_error_messages!
        .feature-box.span3
          %i.icon-cog.large.circle.black
          %h2
            Account
            %span.id-color Details
          %div
            = f.label :email
            = f.email_field :email,:validate => true, :autofocus => true
          %div
            = f.label :password
            = f.password_field :password,:validate => true
          %div
            = f.label :password_confirmation
            = f.password_field :password_confirmation
          = f.fields_for :userprofile do |profile|
            %div
              =hidden_field_tag :plan,params[:plan]
              = profile.label :first_name
              = profile.text_field :first_name,:validate => true
            %div
              = profile.label :last_name
              = profile.text_field :last_name,:validate => true
            %div
              = profile.label :company_name
              = profile.text_field :company_name
            %div
              = profile.label :age
              #dp3.input-append.date{"data-date-format" => "dd-mm-yyyy"}
                = profile.text_field :age, size: "16",readonly: "readonly",:style=>"width:172px;"
                %span.add-on
                  %i.icon-calendar
            %div
              = profile.label :phone
              = profile.text_field :phone
        .feature-box.span3
          = f.fields_for :userprofile do |profile|
            %i.icon-user.large.circle.black
            %h2
              Personal
              %span.id-color Details
            %div
              = profile.label :address
              = profile.text_field :address
            %div
              = profile.label :mailing_address
              = profile.text_field :mailing_address
            %div
              = profile.label :country
              = profile.country_select :country, priority:'', prompt: 'Please select a country',:class=>"selectpicker"
            %div
              = profile.label :state
              = render 'transactions/subregion_select',:parent_region=>profile.object.country
              / = profile.text_field :state
            %div
              = profile.label :city
              = profile.text_field :city
            %div
              = profile.label :zip
              = profile.text_field :zip
        .feature-box.span3
          %i.icon-money.large.circle.black
          %h2
            Payment
            %span.id-color Details
          %div
            %label Card Number
            =f.text_field :card_name, autocomplete: "off", "data-encrypted-name" => "braintree[credit_card][number]", size: "20", type: "text"
          %div
            %label CVV
            =f.text_field :cvv,autocomplete: "off", "data-encrypted-name" => "braintree[credit_card][cvv]", size: "4"
          %div
            %label Expiration (MM/YYYY)
            #dp2.input-append.date{"data-date-format" => "mm/yyyy"}
              =f.text_field :exp_date,"data-encrypted-name" => "braintree[credit_card][expiration_date]",size: "16",readonly: "readonly",:style=>"width:172px;"
              %span.add-on
                %i.icon-calendar
          %div= f.submit "Sign up",:class=>'btn btn-extra-large btn-primary'
%script{src: "https://js.braintreegateway.com/v1/braintree.js"}
/ = render "devise/shared/links"

:css
  .subscription-table td{
    padding-right:100px;
  }
  .field_with_errors input{
    border: 1px dashed #FF624E;
  }
  .field_with_errors label.message{
    display:none;
  }
:javascript
  $(function() {
    $('#dp3,#dp2').datepicker({
      pickTime: false
    });
  });
  $('select#user_userprofile_attributes_country').change(function(){
    var select_wrapper = $('#order_state_code_wrapper');
    $('select', select_wrapper).attr('disabled', true);
    var country_code = $(this).val();
    var url = "/transactions/subregion_options?parent_region="+country_code
    select_wrapper.load(url)
  });
  // braintree client side validations
  var braintree = Braintree.create("MIIBCgKCAQEA1s2p5yYR5/AL1C8yJ3MKK3lOK9QU5TVy7rN+XwzA2QfyAHBQjr04GFUZQYc8Fm4HjPAOwLLbZkrllF+7rzdfXzzzDEYqOgFO9nMQLlc8VyZswjY9toeiqiwmDt9U5AdgvJRpAiw3MakS0ABXdrQOmu6LLoswZd99w1HhdjnRd8TZerCNcp/5r9bYILvErDrXLg7l6LUm9q9tO8ZZSF1zinN+ffkIIwXv6ReRiLXqE3kKgMyDn6VzvRosEIHDlgJvEkJjTdeLBz8yUmX2zJiI0JdOTpFvI8tHGHEqHu9eJqFWa82vrdpWI2IBCgd+OCKwA/Ke9FZXpQbRHKW4YBm1bwIDAQAB");
  braintree.onSubmitEncryptForm("new_user");
  $("#new_user").enableClientSideValidations();
